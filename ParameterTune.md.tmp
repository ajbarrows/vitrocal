<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
<script>
(function() {
  function addWidgetsRenderer() {
    var requireJsScript = document.createElement('script');
    requireJsScript.src = 'https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js';

    var mimeElement = document.querySelector('script[type="application/vnd.jupyter.widget-view+json"]');
    var jupyterWidgetsScript = document.createElement('script');
    var widgetRendererSrc = 'https://unpkg.com/@jupyter-widgets/html-manager@*/dist/embed-amd.js';
    var widgetState;

    // Fallback for older version:
    try {
      widgetState = mimeElement && JSON.parse(mimeElement.innerHTML);

      if (widgetState && (widgetState.version_major < 2 || !widgetState.version_major)) {
        widgetRendererSrc = 'jupyter-js-widgets@*/dist/embed.js';
      }
    } catch(e) {}

    jupyterWidgetsScript.src = widgetRendererSrc;

    document.body.appendChild(requireJsScript);
    document.body.appendChild(jupyterWidgetsScript);
  }

  document.addEventListener('DOMContentLoaded', addWidgetsRenderer);
}());
</script>
<div class="cell border-box-sizing text_cell rendered" markdown="1">
<div class="inner_cell" markdown="1">
<div class="text_cell_render border-box-sizing rendered_html" markdown="1">
[![Binder](https://mybinder.org/badge_logo.svg)](https://mybinder.org/v2/gh/mpmbq2/vitrocal/master?urlpath=lab%2Ftree%2Fdocs%2FParameterTune.ipynb)
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered" markdown="1">
<div class="inner_cell" markdown="1">
<div class="text_cell_render border-box-sizing rendered_html" markdown="1">
## Tune Vitrocal Parameters
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered" markdown="1">
<div class="input">

```python
import os
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns

from vitrocal.datasets import catalog, ExcelDataset
from vitrocal.preprocessors import StandardPreprocessor
from vitrocal.detectors import DerivativeDetector, StandardExtractor
from vitrocal.analyzers import StandardAnalyzer

from vitrocal.plotting import plot_events, plot_average_event
```

</div>
</div>
<div class="cell border-box-sizing text_cell rendered" markdown="1">
<div class="inner_cell" markdown="1">
<div class="text_cell_render border-box-sizing rendered_html" markdown="1">
Pull out functions from `AnalyzeSingle.py` and work with them interactively
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered" markdown="1">
<div class="inner_cell" markdown="1">
<div class="text_cell_render border-box-sizing rendered_html" markdown="1">
### Load example data file
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered" markdown="1">
<div class="input">

```python
def load_data(fpath: str | os.PathLike, load_args: dict={}) -&gt; pd.DataFrame:
    """Load single neuron output file.

    Args:
        fpath (str | os.PathLike): Path to single Excel spreadsheet.
        load_args (dict, optional): Passed to `pd.read_excel()`. Defaults to None.

    Returns:
        pd.DataFrame: Dataframe
    """
    fname = os.path.basename(fpath)
    dataset = ExcelDataset.ExcelDataset(fpath, load_args)
    return dataset.load(), fname
```

</div>
</div>
<div class="cell border-box-sizing code_cell rendered" markdown="1">
<div class="input">

```python
df, fname = load_data("./data/01_raw/E Green.xlsx")
df.head()
```

</div>
<div class="output_wrapper" markdown="1">
<div class="output" markdown="1">
<div class="output_area" markdown="1">
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">1.0</th>
<th style="text-align:right">22.64</th>
<th style="text-align:right">14.464</th>
<th style="text-align:right">81.846</th>
<th style="text-align:right">22.303</th>
<th style="text-align:right">5.206</th>
<th style="text-align:right">13.008</th>
<th style="text-align:right">20.742</th>
<th style="text-align:right">14.349</th>
<th style="text-align:right">17.126</th>
<th style="text-align:right">36.607</th>
<th style="text-align:right">41.751</th>
<th style="text-align:right">17.911</th>
<th style="text-align:right">9.868</th>
<th style="text-align:right">20.88</th>
<th style="text-align:right">10.595</th>
<th style="text-align:right">19.766</th>
<th style="text-align:right">19.937</th>
<th style="text-align:right">20.41</th>
<th style="text-align:right">15.472</th>
<th style="text-align:right">4.139</th>
<th style="text-align:right">12.641</th>
<th style="text-align:right">3.737</th>
<th style="text-align:right">23.991</th>
<th style="text-align:right">16.657</th>
<th style="text-align:right">56.222</th>
<th style="text-align:right">47.472</th>
<th style="text-align:right">23.007</th>
<th style="text-align:right">14.802</th>
<th style="text-align:right">7.97</th>
<th style="text-align:right">20.108</th>
<th style="text-align:right">24.37</th>
<th style="text-align:right">33.058</th>
<th style="text-align:right">24.077</th>
<th style="text-align:right">31.142</th>
<th style="text-align:right">48.045</th>
<th style="text-align:right">4.048</th>
<th style="text-align:right">13.965</th>
<th style="text-align:right">4.224</th>
<th style="text-align:right">12.127</th>
<th style="text-align:right">21.117</th>
<th style="text-align:right">25.81</th>
<th style="text-align:right">33.489</th>
<th style="text-align:right">47.669</th>
<th style="text-align:right">43.951</th>
<th style="text-align:right">14.707</th>
<th style="text-align:right">34.045</th>
<th style="text-align:right">29.163</th>
<th style="text-align:right">15.43</th>
<th style="text-align:right">25.335</th>
<th style="text-align:right">37.077</th>
<th style="text-align:right">27.778</th>
<th style="text-align:right">21.374</th>
<th style="text-align:right">18.34</th>
<th style="text-align:right">10.955</th>
<th style="text-align:right">26.541</th>
<th style="text-align:right">14.188</th>
<th style="text-align:right">5.778</th>
<th style="text-align:right">18.538</th>
<th style="text-align:right">10.539</th>
<th style="text-align:right">31.391</th>
<th style="text-align:right">23.852</th>
<th style="text-align:right">5.949</th>
<th style="text-align:right">2.388</th>
<th style="text-align:right">6.994</th>
<th style="text-align:right">15.802</th>
<th style="text-align:right">21.772</th>
<th style="text-align:right">6.588</th>
<th style="text-align:right">2.145</th>
<th style="text-align:right">22.27</th>
<th style="text-align:right">13.527</th>
<th style="text-align:right">11.289</th>
<th style="text-align:right">44.445</th>
<th style="text-align:right">81.355</th>
<th style="text-align:right">14.337</th>
<th style="text-align:right">3.839</th>
<th style="text-align:right">6.948</th>
<th style="text-align:right">10.796</th>
<th style="text-align:right">8.582</th>
<th style="text-align:right">21.717</th>
<th style="text-align:right">10.199</th>
<th style="text-align:right">15.498</th>
<th style="text-align:right">10.422</th>
<th style="text-align:right">16.775</th>
<th style="text-align:right">5.592</th>
<th style="text-align:right">26.333</th>
<th style="text-align:right">6.552</th>
<th style="text-align:right">1.031</th>
<th style="text-align:right">2.721</th>
<th style="text-align:right">3.963</th>
<th style="text-align:right">2.223</th>
<th style="text-align:right">5.329</th>
<th style="text-align:right">6.514</th>
<th style="text-align:right">6.255</th>
<th style="text-align:right">4.412</th>
<th style="text-align:right">9.865</th>
<th style="text-align:right">13.243</th>
<th style="text-align:right">11.594</th>
<th style="text-align:right">2.955</th>
<th style="text-align:right">5.279</th>
<th style="text-align:right">11.83</th>
<th style="text-align:right">11.454</th>
<th style="text-align:right">1.953</th>
<th style="text-align:right">39.554</th>
<th style="text-align:right">10.668</th>
<th style="text-align:right">8.264</th>
<th style="text-align:right">3.06</th>
<th style="text-align:right">2.67</th>
<th style="text-align:right">7.782</th>
<th style="text-align:right">6.912</th>
<th style="text-align:right">4.135</th>
<th style="text-align:right">3.493</th>
<th style="text-align:right">2.759</th>
<th style="text-align:right">17.813</th>
<th style="text-align:right">12.834</th>
<th style="text-align:right">5.645</th>
<th style="text-align:right">18.946</th>
<th style="text-align:right">4.36</th>
<th style="text-align:right">1.499</th>
<th style="text-align:right">8.511</th>
<th style="text-align:right">5.149</th>
<th style="text-align:right">4.894</th>
<th style="text-align:right">11.065</th>
<th style="text-align:right">11.329</th>
<th style="text-align:right">3.217</th>
<th style="text-align:right">0.882</th>
<th style="text-align:right">5.814</th>
<th style="text-align:right">3.402</th>
<th style="text-align:right">9.316</th>
<th style="text-align:right">1.932</th>
<th style="text-align:right">5.11</th>
<th style="text-align:right">3.497</th>
<th style="text-align:right">6.546</th>
<th style="text-align:right">9.461</th>
<th style="text-align:right">0.725</th>
<th style="text-align:right">1.468</th>
<th style="text-align:right">1.53</th>
<th style="text-align:right">4.134</th>
<th style="text-align:right">11.567</th>
<th style="text-align:right">4.974</th>
<th style="text-align:right">14.442</th>
<th style="text-align:right">11.604</th>
<th style="text-align:right">8.135</th>
<th style="text-align:right">4.038</th>
<th style="text-align:right">19.026</th>
<th style="text-align:right">6.572</th>
<th style="text-align:right">17.669</th>
<th style="text-align:right">7.024</th>
<th style="text-align:right">2.347</th>
<th style="text-align:right">23.887</th>
<th style="text-align:right">42.383</th>
<th style="text-align:right">4.802</th>
<th style="text-align:right">7.62</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">2</td>
<td style="text-align:right">21.593</td>
<td style="text-align:right">13.584</td>
<td style="text-align:right">81.234</td>
<td style="text-align:right">19.634</td>
<td style="text-align:right">4.756</td>
<td style="text-align:right">10.206</td>
<td style="text-align:right">17.576</td>
<td style="text-align:right">14.729</td>
<td style="text-align:right">16.779</td>
<td style="text-align:right">35.217</td>
<td style="text-align:right">41.618</td>
<td style="text-align:right">19.212</td>
<td style="text-align:right">8.937</td>
<td style="text-align:right">20.427</td>
<td style="text-align:right">12.039</td>
<td style="text-align:right">19.362</td>
<td style="text-align:right">16.424</td>
<td style="text-align:right">17.91</td>
<td style="text-align:right">14.662</td>
<td style="text-align:right">3.103</td>
<td style="text-align:right">13.366</td>
<td style="text-align:right">3.516</td>
<td style="text-align:right">19.601</td>
<td style="text-align:right">14.624</td>
<td style="text-align:right">53.055</td>
<td style="text-align:right">44.007</td>
<td style="text-align:right">23.285</td>
<td style="text-align:right">8.433</td>
<td style="text-align:right">7.173</td>
<td style="text-align:right">18.944</td>
<td style="text-align:right">24.039</td>
<td style="text-align:right">29.637</td>
<td style="text-align:right">17.613</td>
<td style="text-align:right">26.709</td>
<td style="text-align:right">46.553</td>
<td style="text-align:right">3.52</td>
<td style="text-align:right">12.971</td>
<td style="text-align:right">4.228</td>
<td style="text-align:right">12.194</td>
<td style="text-align:right">21.007</td>
<td style="text-align:right">23.588</td>
<td style="text-align:right">27.889</td>
<td style="text-align:right">38.282</td>
<td style="text-align:right">28.993</td>
<td style="text-align:right">12.29</td>
<td style="text-align:right">23.852</td>
<td style="text-align:right">26.035</td>
<td style="text-align:right">14.566</td>
<td style="text-align:right">15.605</td>
<td style="text-align:right">34.464</td>
<td style="text-align:right">26.539</td>
<td style="text-align:right">20.894</td>
<td style="text-align:right">20.494</td>
<td style="text-align:right">18.519</td>
<td style="text-align:right">26.556</td>
<td style="text-align:right">12.436</td>
<td style="text-align:right">6.443</td>
<td style="text-align:right">19.505</td>
<td style="text-align:right">9.862</td>
<td style="text-align:right">29.412</td>
<td style="text-align:right">23.273</td>
<td style="text-align:right">5.595</td>
<td style="text-align:right">2.979</td>
<td style="text-align:right">8.025</td>
<td style="text-align:right">14.302</td>
<td style="text-align:right">21.887</td>
<td style="text-align:right">5.397</td>
<td style="text-align:right">1.015</td>
<td style="text-align:right">19.727</td>
<td style="text-align:right">13.343</td>
<td style="text-align:right">12.477</td>
<td style="text-align:right">43.971</td>
<td style="text-align:right">80.403</td>
<td style="text-align:right">14.026</td>
<td style="text-align:right">2.846</td>
<td style="text-align:right">5.977</td>
<td style="text-align:right">11.718</td>
<td style="text-align:right">9.285</td>
<td style="text-align:right">20.809</td>
<td style="text-align:right">10.715</td>
<td style="text-align:right">14.934</td>
<td style="text-align:right">8.254</td>
<td style="text-align:right">14.173</td>
<td style="text-align:right">5.373</td>
<td style="text-align:right">22.842</td>
<td style="text-align:right">7.003</td>
<td style="text-align:right">0.878</td>
<td style="text-align:right">2.641</td>
<td style="text-align:right">3.563</td>
<td style="text-align:right">1.921</td>
<td style="text-align:right">5.611</td>
<td style="text-align:right">4.859</td>
<td style="text-align:right">4.924</td>
<td style="text-align:right">3.632</td>
<td style="text-align:right">9.196</td>
<td style="text-align:right">13.053</td>
<td style="text-align:right">10.581</td>
<td style="text-align:right">2.622</td>
<td style="text-align:right">5.616</td>
<td style="text-align:right">13.149</td>
<td style="text-align:right">12.519</td>
<td style="text-align:right">2.3</td>
<td style="text-align:right">40.23</td>
<td style="text-align:right">10.584</td>
<td style="text-align:right">8.951</td>
<td style="text-align:right">2.233</td>
<td style="text-align:right">2.568</td>
<td style="text-align:right">7.167</td>
<td style="text-align:right">6.485</td>
<td style="text-align:right">3.964</td>
<td style="text-align:right">2.842</td>
<td style="text-align:right">2.549</td>
<td style="text-align:right">12.622</td>
<td style="text-align:right">12.272</td>
<td style="text-align:right">5.446</td>
<td style="text-align:right">15.042</td>
<td style="text-align:right">3.629</td>
<td style="text-align:right">0.963</td>
<td style="text-align:right">5.473</td>
<td style="text-align:right">4.442</td>
<td style="text-align:right">3.624</td>
<td style="text-align:right">9.139</td>
<td style="text-align:right">11.867</td>
<td style="text-align:right">2.705</td>
<td style="text-align:right">0.961</td>
<td style="text-align:right">5.715</td>
<td style="text-align:right">2.773</td>
<td style="text-align:right">8.309</td>
<td style="text-align:right">1.829</td>
<td style="text-align:right">4.57</td>
<td style="text-align:right">3.199</td>
<td style="text-align:right">5.413</td>
<td style="text-align:right">7.278</td>
<td style="text-align:right">0.903</td>
<td style="text-align:right">1.153</td>
<td style="text-align:right">1.108</td>
<td style="text-align:right">4.565</td>
<td style="text-align:right">11.981</td>
<td style="text-align:right">4.357</td>
<td style="text-align:right">12.693</td>
<td style="text-align:right">12.665</td>
<td style="text-align:right">8.902</td>
<td style="text-align:right">3.39</td>
<td style="text-align:right">19.026</td>
<td style="text-align:right">9.156</td>
<td style="text-align:right">16.792</td>
<td style="text-align:right">7.568</td>
<td style="text-align:right">2.142</td>
<td style="text-align:right">25.34</td>
<td style="text-align:right">41.388</td>
<td style="text-align:right">4.14</td>
<td style="text-align:right">7.929</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">3</td>
<td style="text-align:right">20.348</td>
<td style="text-align:right">13.595</td>
<td style="text-align:right">81.041</td>
<td style="text-align:right">22.261</td>
<td style="text-align:right">5.335</td>
<td style="text-align:right">9.868</td>
<td style="text-align:right">13.821</td>
<td style="text-align:right">14.625</td>
<td style="text-align:right">16.988</td>
<td style="text-align:right">35.025</td>
<td style="text-align:right">41.858</td>
<td style="text-align:right">19.988</td>
<td style="text-align:right">8.576</td>
<td style="text-align:right">19.932</td>
<td style="text-align:right">12.599</td>
<td style="text-align:right">18.134</td>
<td style="text-align:right">15.993</td>
<td style="text-align:right">18.343</td>
<td style="text-align:right">14.732</td>
<td style="text-align:right">3.459</td>
<td style="text-align:right">12.605</td>
<td style="text-align:right">3.336</td>
<td style="text-align:right">21.192</td>
<td style="text-align:right">13.157</td>
<td style="text-align:right">51.561</td>
<td style="text-align:right">42.05</td>
<td style="text-align:right">25.224</td>
<td style="text-align:right">13.202</td>
<td style="text-align:right">6.371</td>
<td style="text-align:right">18.256</td>
<td style="text-align:right">23.377</td>
<td style="text-align:right">29.213</td>
<td style="text-align:right">17.994</td>
<td style="text-align:right">28.792</td>
<td style="text-align:right">47.982</td>
<td style="text-align:right">3.696</td>
<td style="text-align:right">12.459</td>
<td style="text-align:right">3.853</td>
<td style="text-align:right">12.135</td>
<td style="text-align:right">20.147</td>
<td style="text-align:right">28.378</td>
<td style="text-align:right">26.521</td>
<td style="text-align:right">36.913</td>
<td style="text-align:right">28.516</td>
<td style="text-align:right">11.704</td>
<td style="text-align:right">25.329</td>
<td style="text-align:right">26.761</td>
<td style="text-align:right">14.345</td>
<td style="text-align:right">14.652</td>
<td style="text-align:right">33.582</td>
<td style="text-align:right">25.009</td>
<td style="text-align:right">21.346</td>
<td style="text-align:right">22.997</td>
<td style="text-align:right">31.845</td>
<td style="text-align:right">26.839</td>
<td style="text-align:right">12.672</td>
<td style="text-align:right">6.858</td>
<td style="text-align:right">18.005</td>
<td style="text-align:right">9.072</td>
<td style="text-align:right">30.19</td>
<td style="text-align:right">23.627</td>
<td style="text-align:right">5.674</td>
<td style="text-align:right">3.332</td>
<td style="text-align:right">8.278</td>
<td style="text-align:right">17.891</td>
<td style="text-align:right">20.573</td>
<td style="text-align:right">5.641</td>
<td style="text-align:right">1.513</td>
<td style="text-align:right">21.549</td>
<td style="text-align:right">13.617</td>
<td style="text-align:right">11.852</td>
<td style="text-align:right">43.506</td>
<td style="text-align:right">81.232</td>
<td style="text-align:right">14.604</td>
<td style="text-align:right">3.07</td>
<td style="text-align:right">5.809</td>
<td style="text-align:right">11.423</td>
<td style="text-align:right">9.95</td>
<td style="text-align:right">21.805</td>
<td style="text-align:right">11.494</td>
<td style="text-align:right">15.252</td>
<td style="text-align:right">7.57</td>
<td style="text-align:right">13.447</td>
<td style="text-align:right">5.04</td>
<td style="text-align:right">21.396</td>
<td style="text-align:right">6.222</td>
<td style="text-align:right">0.932</td>
<td style="text-align:right">2.949</td>
<td style="text-align:right">3.08</td>
<td style="text-align:right">2.606</td>
<td style="text-align:right">5.543</td>
<td style="text-align:right">4.813</td>
<td style="text-align:right">4.904</td>
<td style="text-align:right">4.357</td>
<td style="text-align:right">9.404</td>
<td style="text-align:right">12.882</td>
<td style="text-align:right">11.11</td>
<td style="text-align:right">2.519</td>
<td style="text-align:right">8.492</td>
<td style="text-align:right">8.275</td>
<td style="text-align:right">9.134</td>
<td style="text-align:right">2.051</td>
<td style="text-align:right">40.337</td>
<td style="text-align:right">10.048</td>
<td style="text-align:right">12.379</td>
<td style="text-align:right">2.648</td>
<td style="text-align:right">2.789</td>
<td style="text-align:right">7.503</td>
<td style="text-align:right">6.553</td>
<td style="text-align:right">3.921</td>
<td style="text-align:right">2.906</td>
<td style="text-align:right">2.929</td>
<td style="text-align:right">16.767</td>
<td style="text-align:right">11.948</td>
<td style="text-align:right">4.964</td>
<td style="text-align:right">14.949</td>
<td style="text-align:right">3.739</td>
<td style="text-align:right">0.771</td>
<td style="text-align:right">5.646</td>
<td style="text-align:right">3.79</td>
<td style="text-align:right">3.478</td>
<td style="text-align:right">9.129</td>
<td style="text-align:right">10.963</td>
<td style="text-align:right">2.029</td>
<td style="text-align:right">0.931</td>
<td style="text-align:right">5.665</td>
<td style="text-align:right">2.127</td>
<td style="text-align:right">10.181</td>
<td style="text-align:right">1.671</td>
<td style="text-align:right">4.47</td>
<td style="text-align:right">3.242</td>
<td style="text-align:right">5.476</td>
<td style="text-align:right">7.972</td>
<td style="text-align:right">0.841</td>
<td style="text-align:right">1.459</td>
<td style="text-align:right">1.115</td>
<td style="text-align:right">3.671</td>
<td style="text-align:right">12.008</td>
<td style="text-align:right">3.735</td>
<td style="text-align:right">12.307</td>
<td style="text-align:right">12.157</td>
<td style="text-align:right">11.045</td>
<td style="text-align:right">4.179</td>
<td style="text-align:right">18.215</td>
<td style="text-align:right">7.307</td>
<td style="text-align:right">17.28</td>
<td style="text-align:right">7.383</td>
<td style="text-align:right">2.056</td>
<td style="text-align:right">27.561</td>
<td style="text-align:right">41.679</td>
<td style="text-align:right">3.816</td>
<td style="text-align:right">6.994</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">4</td>
<td style="text-align:right">22.938</td>
<td style="text-align:right">13.941</td>
<td style="text-align:right">81.42</td>
<td style="text-align:right">21.579</td>
<td style="text-align:right">5.41</td>
<td style="text-align:right">9.857</td>
<td style="text-align:right">13.642</td>
<td style="text-align:right">14.422</td>
<td style="text-align:right">16.672</td>
<td style="text-align:right">36.755</td>
<td style="text-align:right">42.189</td>
<td style="text-align:right">17.823</td>
<td style="text-align:right">8.742</td>
<td style="text-align:right">20.371</td>
<td style="text-align:right">12.414</td>
<td style="text-align:right">20.368</td>
<td style="text-align:right">15.031</td>
<td style="text-align:right">18.836</td>
<td style="text-align:right">15.535</td>
<td style="text-align:right">3.614</td>
<td style="text-align:right">13.246</td>
<td style="text-align:right">4.64</td>
<td style="text-align:right">23.625</td>
<td style="text-align:right">13.159</td>
<td style="text-align:right">49.022</td>
<td style="text-align:right">44.062</td>
<td style="text-align:right">23.184</td>
<td style="text-align:right">15.562</td>
<td style="text-align:right">7.82</td>
<td style="text-align:right">19.547</td>
<td style="text-align:right">23.16</td>
<td style="text-align:right">30.782</td>
<td style="text-align:right">17.573</td>
<td style="text-align:right">31.105</td>
<td style="text-align:right">50.289</td>
<td style="text-align:right">3.798</td>
<td style="text-align:right">16.024</td>
<td style="text-align:right">4.203</td>
<td style="text-align:right">13.754</td>
<td style="text-align:right">18.941</td>
<td style="text-align:right">25.104</td>
<td style="text-align:right">25.906</td>
<td style="text-align:right">50.987</td>
<td style="text-align:right">36.556</td>
<td style="text-align:right">12.653</td>
<td style="text-align:right">40.189</td>
<td style="text-align:right">28.196</td>
<td style="text-align:right">14.98</td>
<td style="text-align:right">20.615</td>
<td style="text-align:right">33.157</td>
<td style="text-align:right">24.692</td>
<td style="text-align:right">21.14</td>
<td style="text-align:right">18.301</td>
<td style="text-align:right">11.646</td>
<td style="text-align:right">32.98</td>
<td style="text-align:right">14.338</td>
<td style="text-align:right">6.791</td>
<td style="text-align:right">18.613</td>
<td style="text-align:right">8.52</td>
<td style="text-align:right">31.369</td>
<td style="text-align:right">23.359</td>
<td style="text-align:right">6.022</td>
<td style="text-align:right">2.82</td>
<td style="text-align:right">6.986</td>
<td style="text-align:right">22.005</td>
<td style="text-align:right">23.624</td>
<td style="text-align:right">6.034</td>
<td style="text-align:right">1.418</td>
<td style="text-align:right">20.523</td>
<td style="text-align:right">13.947</td>
<td style="text-align:right">11.756</td>
<td style="text-align:right">43.623</td>
<td style="text-align:right">80.777</td>
<td style="text-align:right">15.209</td>
<td style="text-align:right">2.846</td>
<td style="text-align:right">6</td>
<td style="text-align:right">15.331</td>
<td style="text-align:right">11.741</td>
<td style="text-align:right">21.113</td>
<td style="text-align:right">10.529</td>
<td style="text-align:right">14.4</td>
<td style="text-align:right">8.578</td>
<td style="text-align:right">15.43</td>
<td style="text-align:right">4.171</td>
<td style="text-align:right">25.491</td>
<td style="text-align:right">6.243</td>
<td style="text-align:right">0.745</td>
<td style="text-align:right">2.386</td>
<td style="text-align:right">3.217</td>
<td style="text-align:right">2.791</td>
<td style="text-align:right">6.689</td>
<td style="text-align:right">5.775</td>
<td style="text-align:right">5.35</td>
<td style="text-align:right">4.139</td>
<td style="text-align:right">8.47</td>
<td style="text-align:right">13.114</td>
<td style="text-align:right">11.333</td>
<td style="text-align:right">2.758</td>
<td style="text-align:right">6.515</td>
<td style="text-align:right">11.45</td>
<td style="text-align:right">9.275</td>
<td style="text-align:right">2.354</td>
<td style="text-align:right">40.311</td>
<td style="text-align:right">11.358</td>
<td style="text-align:right">8.615</td>
<td style="text-align:right">2.858</td>
<td style="text-align:right">2.818</td>
<td style="text-align:right">6.747</td>
<td style="text-align:right">6.591</td>
<td style="text-align:right">4.316</td>
<td style="text-align:right">2.173</td>
<td style="text-align:right">2.959</td>
<td style="text-align:right">11.822</td>
<td style="text-align:right">11.904</td>
<td style="text-align:right">4.558</td>
<td style="text-align:right">22.492</td>
<td style="text-align:right">3.313</td>
<td style="text-align:right">1.335</td>
<td style="text-align:right">5.819</td>
<td style="text-align:right">3.896</td>
<td style="text-align:right">3.69</td>
<td style="text-align:right">9.771</td>
<td style="text-align:right">10.027</td>
<td style="text-align:right">2.282</td>
<td style="text-align:right">0.813</td>
<td style="text-align:right">5.769</td>
<td style="text-align:right">2.367</td>
<td style="text-align:right">10.986</td>
<td style="text-align:right">1.943</td>
<td style="text-align:right">4.317</td>
<td style="text-align:right">3.32</td>
<td style="text-align:right">5.56</td>
<td style="text-align:right">8.638</td>
<td style="text-align:right">0.83</td>
<td style="text-align:right">2.032</td>
<td style="text-align:right">1</td>
<td style="text-align:right">3.933</td>
<td style="text-align:right">11.231</td>
<td style="text-align:right">3.534</td>
<td style="text-align:right">14.448</td>
<td style="text-align:right">11.857</td>
<td style="text-align:right">7.908</td>
<td style="text-align:right">3.982</td>
<td style="text-align:right">19.623</td>
<td style="text-align:right">7.675</td>
<td style="text-align:right">16.628</td>
<td style="text-align:right">7.272</td>
<td style="text-align:right">2.002</td>
<td style="text-align:right">23.3</td>
<td style="text-align:right">41.452</td>
<td style="text-align:right">3.906</td>
<td style="text-align:right">7.85</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">5</td>
<td style="text-align:right">20.889</td>
<td style="text-align:right">12.441</td>
<td style="text-align:right">81.222</td>
<td style="text-align:right">20.25</td>
<td style="text-align:right">5.081</td>
<td style="text-align:right">11.525</td>
<td style="text-align:right">12.387</td>
<td style="text-align:right">13.078</td>
<td style="text-align:right">16.708</td>
<td style="text-align:right">36.005</td>
<td style="text-align:right">43.322</td>
<td style="text-align:right">18.191</td>
<td style="text-align:right">8.457</td>
<td style="text-align:right">20.146</td>
<td style="text-align:right">13.188</td>
<td style="text-align:right">19.511</td>
<td style="text-align:right">14.888</td>
<td style="text-align:right">18.262</td>
<td style="text-align:right">15.401</td>
<td style="text-align:right">3.946</td>
<td style="text-align:right">13.002</td>
<td style="text-align:right">3.573</td>
<td style="text-align:right">18.932</td>
<td style="text-align:right">12.759</td>
<td style="text-align:right">50.234</td>
<td style="text-align:right">41.34</td>
<td style="text-align:right">23.786</td>
<td style="text-align:right">9.233</td>
<td style="text-align:right">6.975</td>
<td style="text-align:right">19.435</td>
<td style="text-align:right">23.023</td>
<td style="text-align:right">27.475</td>
<td style="text-align:right">16.595</td>
<td style="text-align:right">28.741</td>
<td style="text-align:right">54.258</td>
<td style="text-align:right">4.17</td>
<td style="text-align:right">17.441</td>
<td style="text-align:right">4.819</td>
<td style="text-align:right">14.448</td>
<td style="text-align:right">20.308</td>
<td style="text-align:right">25.515</td>
<td style="text-align:right">37.709</td>
<td style="text-align:right">51.115</td>
<td style="text-align:right">34.365</td>
<td style="text-align:right">16.798</td>
<td style="text-align:right">34.206</td>
<td style="text-align:right">28.043</td>
<td style="text-align:right">15.964</td>
<td style="text-align:right">21.641</td>
<td style="text-align:right">34.325</td>
<td style="text-align:right">25.546</td>
<td style="text-align:right">22.569</td>
<td style="text-align:right">22.824</td>
<td style="text-align:right">29.187</td>
<td style="text-align:right">25.185</td>
<td style="text-align:right">13.911</td>
<td style="text-align:right">4.314</td>
<td style="text-align:right">17.976</td>
<td style="text-align:right">9.276</td>
<td style="text-align:right">29.437</td>
<td style="text-align:right">22.496</td>
<td style="text-align:right">6.233</td>
<td style="text-align:right">3.011</td>
<td style="text-align:right">7.956</td>
<td style="text-align:right">18.768</td>
<td style="text-align:right">21.349</td>
<td style="text-align:right">4.718</td>
<td style="text-align:right">1.138</td>
<td style="text-align:right">20.24</td>
<td style="text-align:right">14.065</td>
<td style="text-align:right">11.81</td>
<td style="text-align:right">43.708</td>
<td style="text-align:right">81.537</td>
<td style="text-align:right">15.271</td>
<td style="text-align:right">3.692</td>
<td style="text-align:right">6.439</td>
<td style="text-align:right">11.275</td>
<td style="text-align:right">9.536</td>
<td style="text-align:right">21.072</td>
<td style="text-align:right">11.529</td>
<td style="text-align:right">12.211</td>
<td style="text-align:right">8.117</td>
<td style="text-align:right">17.596</td>
<td style="text-align:right">5.169</td>
<td style="text-align:right">26.095</td>
<td style="text-align:right">6.788</td>
<td style="text-align:right">0.879</td>
<td style="text-align:right">3.225</td>
<td style="text-align:right">3.495</td>
<td style="text-align:right">2.627</td>
<td style="text-align:right">5.854</td>
<td style="text-align:right">5.248</td>
<td style="text-align:right">4.984</td>
<td style="text-align:right">4.253</td>
<td style="text-align:right">8.541</td>
<td style="text-align:right">12.895</td>
<td style="text-align:right">11.912</td>
<td style="text-align:right">2.357</td>
<td style="text-align:right">5.085</td>
<td style="text-align:right">8.408</td>
<td style="text-align:right">13.811</td>
<td style="text-align:right">1.591</td>
<td style="text-align:right">39.343</td>
<td style="text-align:right">11.265</td>
<td style="text-align:right">12.611</td>
<td style="text-align:right">2.801</td>
<td style="text-align:right">4.18</td>
<td style="text-align:right">7.086</td>
<td style="text-align:right">6.418</td>
<td style="text-align:right">4.321</td>
<td style="text-align:right">3.928</td>
<td style="text-align:right">3.797</td>
<td style="text-align:right">16.494</td>
<td style="text-align:right">11.794</td>
<td style="text-align:right">4.77</td>
<td style="text-align:right">16.438</td>
<td style="text-align:right">2.747</td>
<td style="text-align:right">0.815</td>
<td style="text-align:right">5.681</td>
<td style="text-align:right">3.866</td>
<td style="text-align:right">3.916</td>
<td style="text-align:right">9.174</td>
<td style="text-align:right">10.751</td>
<td style="text-align:right">4.593</td>
<td style="text-align:right">1.064</td>
<td style="text-align:right">6.226</td>
<td style="text-align:right">2.389</td>
<td style="text-align:right">8.443</td>
<td style="text-align:right">2.089</td>
<td style="text-align:right">4.551</td>
<td style="text-align:right">3.39</td>
<td style="text-align:right">5.217</td>
<td style="text-align:right">8.226</td>
<td style="text-align:right">1.135</td>
<td style="text-align:right">1.486</td>
<td style="text-align:right">1.592</td>
<td style="text-align:right">3.765</td>
<td style="text-align:right">11.472</td>
<td style="text-align:right">2.677</td>
<td style="text-align:right">14.847</td>
<td style="text-align:right">12.522</td>
<td style="text-align:right">8.995</td>
<td style="text-align:right">4.201</td>
<td style="text-align:right">19.561</td>
<td style="text-align:right">5.383</td>
<td style="text-align:right">20.522</td>
<td style="text-align:right">7.516</td>
<td style="text-align:right">1.527</td>
<td style="text-align:right">19.236</td>
<td style="text-align:right">46.553</td>
<td style="text-align:right">4.277</td>
<td style="text-align:right">7.748</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">6</td>
<td style="text-align:right">21.691</td>
<td style="text-align:right">14.711</td>
<td style="text-align:right">81.017</td>
<td style="text-align:right">21.015</td>
<td style="text-align:right">5.553</td>
<td style="text-align:right">11.386</td>
<td style="text-align:right">17.477</td>
<td style="text-align:right">13.776</td>
<td style="text-align:right">16.634</td>
<td style="text-align:right">36.942</td>
<td style="text-align:right">42.03</td>
<td style="text-align:right">18.863</td>
<td style="text-align:right">8.603</td>
<td style="text-align:right">19.629</td>
<td style="text-align:right">13.885</td>
<td style="text-align:right">19.031</td>
<td style="text-align:right">19.595</td>
<td style="text-align:right">19.676</td>
<td style="text-align:right">15.528</td>
<td style="text-align:right">4.066</td>
<td style="text-align:right">14.426</td>
<td style="text-align:right">4.07</td>
<td style="text-align:right">22.118</td>
<td style="text-align:right">12.436</td>
<td style="text-align:right">50.539</td>
<td style="text-align:right">42.4</td>
<td style="text-align:right">23.164</td>
<td style="text-align:right">15.014</td>
<td style="text-align:right">8.122</td>
<td style="text-align:right">18.742</td>
<td style="text-align:right">22.986</td>
<td style="text-align:right">28.414</td>
<td style="text-align:right">18.06</td>
<td style="text-align:right">28.311</td>
<td style="text-align:right">50.209</td>
<td style="text-align:right">4.213</td>
<td style="text-align:right">14.686</td>
<td style="text-align:right">5.397</td>
<td style="text-align:right">17.018</td>
<td style="text-align:right">19.74</td>
<td style="text-align:right">24.293</td>
<td style="text-align:right">23.319</td>
<td style="text-align:right">31.575</td>
<td style="text-align:right">40.299</td>
<td style="text-align:right">14.855</td>
<td style="text-align:right">32.047</td>
<td style="text-align:right">29.106</td>
<td style="text-align:right">14.938</td>
<td style="text-align:right">14.835</td>
<td style="text-align:right">32.504</td>
<td style="text-align:right">25.384</td>
<td style="text-align:right">21.501</td>
<td style="text-align:right">22.106</td>
<td style="text-align:right">9.479</td>
<td style="text-align:right">23.376</td>
<td style="text-align:right">14.137</td>
<td style="text-align:right">6.36</td>
<td style="text-align:right">18.019</td>
<td style="text-align:right">9.125</td>
<td style="text-align:right">29.301</td>
<td style="text-align:right">22.136</td>
<td style="text-align:right">5.914</td>
<td style="text-align:right">3.18</td>
<td style="text-align:right">6.694</td>
<td style="text-align:right">13.165</td>
<td style="text-align:right">21.07</td>
<td style="text-align:right">5.481</td>
<td style="text-align:right">1.284</td>
<td style="text-align:right">19.299</td>
<td style="text-align:right">19.054</td>
<td style="text-align:right">14.044</td>
<td style="text-align:right">43.553</td>
<td style="text-align:right">80.785</td>
<td style="text-align:right">15.33</td>
<td style="text-align:right">2.736</td>
<td style="text-align:right">5.979</td>
<td style="text-align:right">11.511</td>
<td style="text-align:right">9.841</td>
<td style="text-align:right">21.478</td>
<td style="text-align:right">11.151</td>
<td style="text-align:right">10.596</td>
<td style="text-align:right">7.859</td>
<td style="text-align:right">15.193</td>
<td style="text-align:right">4.594</td>
<td style="text-align:right">20.486</td>
<td style="text-align:right">8.331</td>
<td style="text-align:right">0.751</td>
<td style="text-align:right">2.828</td>
<td style="text-align:right">3.098</td>
<td style="text-align:right">3.185</td>
<td style="text-align:right">6.886</td>
<td style="text-align:right">5.425</td>
<td style="text-align:right">5.854</td>
<td style="text-align:right">3.98</td>
<td style="text-align:right">8.026</td>
<td style="text-align:right">13.825</td>
<td style="text-align:right">13.499</td>
<td style="text-align:right">2.406</td>
<td style="text-align:right">4.373</td>
<td style="text-align:right">7.558</td>
<td style="text-align:right">7.326</td>
<td style="text-align:right">2.463</td>
<td style="text-align:right">39.82</td>
<td style="text-align:right">10.4</td>
<td style="text-align:right">10.677</td>
<td style="text-align:right">2.75</td>
<td style="text-align:right">5.006</td>
<td style="text-align:right">7.67</td>
<td style="text-align:right">6.357</td>
<td style="text-align:right">3.805</td>
<td style="text-align:right">2.748</td>
<td style="text-align:right">3.175</td>
<td style="text-align:right">12.356</td>
<td style="text-align:right">12.252</td>
<td style="text-align:right">5.103</td>
<td style="text-align:right">15.511</td>
<td style="text-align:right">3.082</td>
<td style="text-align:right">0.905</td>
<td style="text-align:right">5.66</td>
<td style="text-align:right">5.07</td>
<td style="text-align:right">4.841</td>
<td style="text-align:right">7.925</td>
<td style="text-align:right">9.645</td>
<td style="text-align:right">2.562</td>
<td style="text-align:right">0.98</td>
<td style="text-align:right">5.865</td>
<td style="text-align:right">2.541</td>
<td style="text-align:right">7.457</td>
<td style="text-align:right">1.893</td>
<td style="text-align:right">4.04</td>
<td style="text-align:right">3.15</td>
<td style="text-align:right">5.425</td>
<td style="text-align:right">9.489</td>
<td style="text-align:right">1.224</td>
<td style="text-align:right">1.491</td>
<td style="text-align:right">1.268</td>
<td style="text-align:right">4.267</td>
<td style="text-align:right">10.709</td>
<td style="text-align:right">2.42</td>
<td style="text-align:right">13.957</td>
<td style="text-align:right">12.126</td>
<td style="text-align:right">9.518</td>
<td style="text-align:right">3.926</td>
<td style="text-align:right">19.548</td>
<td style="text-align:right">5.114</td>
<td style="text-align:right">18.126</td>
<td style="text-align:right">7.079</td>
<td style="text-align:right">1.802</td>
<td style="text-align:right">23.3</td>
<td style="text-align:right">45.417</td>
<td style="text-align:right">4.044</td>
<td style="text-align:right">7.735</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered" markdown="1">
<div class="inner_cell" markdown="1">
<div class="text_cell_render border-box-sizing rendered_html" markdown="1">
Note: you want to be super careful about loading your files and looking at them first.
These files don't have a header, and sometimes they have numbered rows like this one.

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered" markdown="1">
<div class="input">

```python
load_args = {'header': None, 'index_col': 0}
df, fname = load_data("./data/01_raw/E Green.xlsx", load_args)
```

</div>
</div>
<div class="cell border-box-sizing text_cell rendered" markdown="1">
<div class="inner_cell" markdown="1">
<div class="text_cell_render border-box-sizing rendered_html" markdown="1">
`Vitrocal` is organized into three distinct modules for data analysis:
* `vitrocal.preprocessors`
* `vitrocal.detectors`
* `vitrocal.analyzers`

You'll want to explore the parameter space for each of these individually and assess
the impacts different parameter combinations have on your data.

See [the documentation](https://ajbarrow.w3.uvm.edu/assets/public_share/vitrocal_docs/api/) for details.
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered" markdown="1">
<div class="inner_cell" markdown="1">
<div class="text_cell_render border-box-sizing rendered_html" markdown="1">
### Preprocess
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered" markdown="1">
<div class="input">

```python
# change these
fps = 1/2.5
bleach_period = 60
filter_frequency = None
baseline_threshold = 10 # percent
preprocess_window_size = 60 # seconds

# instantiate the StandardPreprocess object with these parameters
preprocessor = StandardPreprocessor(
        frames_per_second=1/2.5,
        bleach_period=bleach_period,
        filter_frequency=filter_frequency,
        baseline_threshold=baseline_threshold,
        window_size=preprocess_window_size
)
```

</div>
</div>
<div class="cell border-box-sizing code_cell rendered" markdown="1">
<div class="input">

```python
# call the object's `preprocess` method
# see the documentation for other methods available

processed = preprocessor.preprocess(df)
```

</div>
<div class="output_wrapper" markdown="1">
<div class="output" markdown="1">
<div class="output_area" markdown="1">
<div class="output_subarea output_stream output_stdout output_text">
<pre>
<code>No filter applied.
</code>
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered" markdown="1">
<div class="inner_cell" markdown="1">
<div class="text_cell_render border-box-sizing rendered_html" markdown="1">
## Detect and Extract
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered" markdown="1">
<div class="input">

```python
# change this
threshold = 20 # percent
detector = DerivativeDetector(threshold)

detected = detector.detect(processed)
```

</div>
</div>
<div class="cell border-box-sizing text_cell rendered" markdown="1">
<div class="inner_cell" markdown="1">
<div class="text_cell_render border-box-sizing rendered_html" markdown="1">
## Extract 

Note: the `StandardExtractor` class has a `detect_and_extract` method
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered" markdown="1">
<div class="input">

```python
# change these
window = (3, 30) # seconds before and after
threshold = 20 # percent

extractor = StandardExtractor(
    window=window,
    frames_per_second=fps, # defined above
    threshold=threshold
)

events = extractor.extract(processed, detected)
```

</div>
<div class="output_wrapper" markdown="1">
<div class="output" markdown="1">
<div class="output_area" markdown="1">
<div class="output_subarea output_stream output_stdout output_text">
<pre>
<code>With FPS = 0.4, a window of (3, 30) seconds captures 1 frame(s) before and 12 frame(s) after each event.
</code>
</pre>
</div>
</div>
<div class="output_area" markdown="1">
<div class="output_subarea output_stream output_stderr output_text">
<pre>
<code>/Users/tony/Documents/phd/projects/other/vitrocal/vitrocal/detectors.py:137: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead. To get a de-fragmented frame, use `newframe = frame.copy()`
  identified[identified is False] = np.NaN # non-events
</code>
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered" markdown="1">
<div class="inner_cell" markdown="1">
<div class="text_cell_render border-box-sizing rendered_html" markdown="1">
Note: this method returns events as a Python dictionary. You can examine individual events, if you like:
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered" markdown="1">
<div class="input">

```python
roi = 2
# events[roi]
```

</div>
</div>
<div class="cell border-box-sizing text_cell rendered" markdown="1">
<div class="inner_cell" markdown="1">
<div class="text_cell_render border-box-sizing rendered_html" markdown="1">
## Analyze
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered" markdown="1">
<div class="input">

```python
# change these
upper_decay_bound = 0.8 # proportion
lower_decay_bound = 0.2 # proportion

analyzer = StandardAnalyzer(
    upper_decay_bound=upper_decay_bound,
    lower_decay_bound=lower_decay_bound
)

result, avg_result = analyzer.analyze(events)
```

</div>
</div>
<div class="cell border-box-sizing code_cell rendered" markdown="1">
<div class="input">

```python
result.head()
```

</div>
<div class="output_wrapper" markdown="1">
<div class="output" markdown="1">
<div class="output_area" markdown="1">
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">roi</th>
<th style="text-align:right">event</th>
<th style="text-align:right">peak</th>
<th style="text-align:right">upper</th>
<th style="text-align:right">lower</th>
<th style="text-align:right">decay</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">2</td>
<td style="text-align:right">1</td>
<td style="text-align:right">27.2195</td>
<td style="text-align:right">21.2979</td>
<td style="text-align:right">2.42369</td>
<td style="text-align:right">18.8742</td>
</tr>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">5</td>
<td style="text-align:right">1</td>
<td style="text-align:right">21.8511</td>
<td style="text-align:right">6.71749</td>
<td style="text-align:right">-3.25337</td>
<td style="text-align:right">9.97087</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">5</td>
<td style="text-align:right">2</td>
<td style="text-align:right">38.5962</td>
<td style="text-align:right">15.0923</td>
<td style="text-align:right">1.50109</td>
<td style="text-align:right">13.5912</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">5</td>
<td style="text-align:right">3</td>
<td style="text-align:right">37.8041</td>
<td style="text-align:right">21.5407</td>
<td style="text-align:right">1.03699</td>
<td style="text-align:right">20.5037</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">5</td>
<td style="text-align:right">4</td>
<td style="text-align:right">28.5376</td>
<td style="text-align:right">17.3164</td>
<td style="text-align:right">nan</td>
<td style="text-align:right">nan</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered" markdown="1">
<div class="input">

```python
avg_result.head()
```

</div>
<div class="output_wrapper" markdown="1">
<div class="output" markdown="1">
<div class="output_area" markdown="1">
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">roi</th>
<th style="text-align:right">total_events</th>
<th style="text-align:right">average_peak</th>
<th style="text-align:right">average_decay</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">2</td>
<td style="text-align:right">1</td>
<td style="text-align:right">27.2195</td>
<td style="text-align:right">18.8742</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">5</td>
<td style="text-align:right">8</td>
<td style="text-align:right">35.1237</td>
<td style="text-align:right">14.3551</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">6</td>
<td style="text-align:right">20</td>
<td style="text-align:right">52.5964</td>
<td style="text-align:right">21.5584</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">7</td>
<td style="text-align:right">29</td>
<td style="text-align:right">67.1418</td>
<td style="text-align:right">30.6436</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">13</td>
<td style="text-align:right">6</td>
<td style="text-align:right">29.6881</td>
<td style="text-align:right">14.3257</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered" markdown="1">
<div class="inner_cell" markdown="1">
<div class="text_cell_render border-box-sizing rendered_html" markdown="1">
## Plotting

Jupyter notebooks are very helpful for making quick plots to confirm your intuition about an analysis problem. The syntax can be tricky: https://matplotlib.org

[Seaborn](https://seaborn.pydata.org) can make life a little easier, but you generally need to work with `pandas.DataFrames` for the input data.
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered" markdown="1">
<div class="inner_cell" markdown="1">
<div class="text_cell_render border-box-sizing rendered_html" markdown="1">
## Average Events

As an example, we might want to look at average intensity for a trace, or across all traces. 
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered" markdown="1">
<div class="input">

```python
global_average, roi_average, event_data = analyzer.find_average_event(events)
global_average.head()
```

</div>
<div class="output_wrapper" markdown="1">
<div class="output" markdown="1">
<div class="output_area" markdown="1">
<table>
<thead>
<tr>
<th style="text-align:right"><br/><br/>index</th>
<th style="text-align:right">q1<br/><br/> </th>
<th style="text-align:right">q3<br/><br/> </th>
<th style="text-align:right">median<br/><br/> </th>
<th style="text-align:right">mean<br/><br/> </th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">-3.00963</td>
<td style="text-align:right">8.86682</td>
<td style="text-align:right">1.29585</td>
<td style="text-align:right">3.84374</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">24.6512</td>
<td style="text-align:right">48.0814</td>
<td style="text-align:right">33.9981</td>
<td style="text-align:right">40.1769</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">3.18477</td>
<td style="text-align:right">26.4741</td>
<td style="text-align:right">12.8264</td>
<td style="text-align:right">17.6446</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">3.05635</td>
<td style="text-align:right">25.6205</td>
<td style="text-align:right">12.851</td>
<td style="text-align:right">17.9426</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">2.526</td>
<td style="text-align:right">25.4279</td>
<td style="text-align:right">11.7944</td>
<td style="text-align:right">17.0295</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered" markdown="1">
<div class="input">

```python
roi_average.head()
```

</div>
<div class="output_wrapper" markdown="1">
<div class="output" markdown="1">
<div class="output_area" markdown="1">
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">roi</th>
<th style="text-align:right">index</th>
<th style="text-align:right">q1</th>
<th style="text-align:right">q3</th>
<th style="text-align:right">median</th>
<th style="text-align:right">mean</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">2</td>
<td style="text-align:right">0</td>
<td style="text-align:right">-4.44124</td>
<td style="text-align:right">-4.44124</td>
<td style="text-align:right">-4.44124</td>
<td style="text-align:right">-4.44124</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">2</td>
<td style="text-align:right">1</td>
<td style="text-align:right">27.2195</td>
<td style="text-align:right">27.2195</td>
<td style="text-align:right">27.2195</td>
<td style="text-align:right">27.2195</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">2</td>
<td style="text-align:right">2</td>
<td style="text-align:right">21.2979</td>
<td style="text-align:right">21.2979</td>
<td style="text-align:right">21.2979</td>
<td style="text-align:right">21.2979</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">2</td>
<td style="text-align:right">3</td>
<td style="text-align:right">14.791</td>
<td style="text-align:right">14.791</td>
<td style="text-align:right">14.791</td>
<td style="text-align:right">14.791</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">2</td>
<td style="text-align:right">4</td>
<td style="text-align:right">21.0446</td>
<td style="text-align:right">21.0446</td>
<td style="text-align:right">21.0446</td>
<td style="text-align:right">21.0446</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered" markdown="1">
<div class="input">

```python
plot_average_event(global_average)
plt.show()
```

</div>
<div class="output_wrapper" markdown="1">
<div class="output" markdown="1">
<div class="output_area" markdown="1">
<div class="output_png output_subarea">
<img alt="No description has been provided for this image" src="output_27_0.png"/>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered" markdown="1">
<div class="input">

```python
selected_roi = 15
plot_average_event(roi_average[roi_average['roi'] == selected_roi],
                   title='Average Event for ROI {}'.format(selected_roi))
plt.show()
```

</div>
<div class="output_wrapper" markdown="1">
<div class="output" markdown="1">
<div class="output_area" markdown="1">
<div class="output_png output_subarea">
<img alt="No description has been provided for this image" src="output_28_0.png"/>
</div>
</div>
</div>
</div>
</div>
